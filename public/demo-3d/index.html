<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Model Viewer - Model Viewer</title>
    <style>
        body {
            margin: 0;
            padding: 0px;
            font-family: Arial, sans-serif;
            background: #272727;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 1px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: #333;
            color: white;
            padding: 10px;
            text-align: center;
        }
        
        .viewer-container {
            position: relative;
            height: 400px;
            background: #222;
            margin: 10px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .viewer-container {
                height: 500px;
                margin: 20px;
            }
        }
        
        @media (min-width: 1024px) {
            .viewer-container {
                height: 600px;
            }
        }
        
        model-viewer {
            width: 100%;
            height: 100%;
            background-color: #bbb;
        }
        
        /* ƒê·ªïi m√†u progress bar m·∫∑c ƒë·ªãnh c·ªßa model-viewer th√†nh royalblue */
        model-viewer::part(default-progress-mask) {
            background: rgba(65, 105, 225, 0.2) !important;
        }
        
        model-viewer::part(default-progress-bar) {
            background: linear-gradient(90deg, #4169E1, #6495ED) !important;
            box-shadow: 0 2px 8px rgba(65, 105, 225, 0.4) !important;
        }
        
        /* Container cho to√†n b·ªô viewer v√† 4 n√∫t */
        .viewer-wrapper {
            position: relative;
            padding: 20px 20px;
        }
        
        /* 4 n√∫t g√≥c ·ªü ngo√†i khung */
        .light-controls {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
        
        .light-btn {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid #fff;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            font-size: 16px;
            cursor: pointer;
            pointer-events: auto;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            user-select: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .light-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
        }
        
        .light-btn.active {
            background: rgba(255, 215, 0, 0.9);
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            color: #000;
        }
        
        /* ƒê·∫∑t 4 ƒë√®n ·ªü 4 g√≥c */
        .light-top-left {
            top: 10px;
            left: 10px;
        }
        
        .light-top-right {
            top: 10px;
            right: 10px;
        }
        
        .light-bottom-left {
            bottom: 10px;
            left: 10px;
        }
        
        .light-bottom-right {
            bottom: 10px;
            right: 10px;
        }
        
        .info {
            padding: 20px;
            background: #f8f9fa;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        
        .info-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .info-card h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .controls {
            padding: 15px;
            background: #e9ecef;
            text-align: center;
        }
        
        .button-group {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 10px;
        }
        
        .compact-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        @media (min-width: 768px) {
            .compact-controls {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (min-width: 1024px) {
            .compact-controls {
                grid-template-columns: repeat(5, 1fr);
            }
        }
        
        button {
            padding: 8px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s;
            white-space: nowrap;
        }
        
        @media (min-width: 768px) {
            button {
                font-size: 14px;
                padding: 10px 15px;
            }
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .status {
            margin-top: 15px;
            padding: 10px;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            color: #155724;
        }
        
        .button-group button {
            margin: 2px;
            padding: 6px 10px;
            border: 2px solid transparent;
            border-radius: 5px;
            background: linear-gradient(145deg, #f0f0f0, #d0d0d0);
            color: #333;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.2);
            min-width: 35px;
        }
        
        @media (min-width: 768px) {
            .button-group button {
                margin: 3px;
                padding: 8px 12px;
                font-size: 12px;
                min-width: 40px;
            }
        }
        
        .button-group button:hover {
            transform: translateY(-1px);
            box-shadow: 2px 2px 6px rgba(0,0,0,0.3);
            border-color: #4CAF50;
        }
        
        .button-group button:active {
            transform: translateY(0);
            box-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        
        .color-label {
            font-size: 11px;
            font-weight: bold;
            color: #333;
            margin-right: 5px;
            white-space: nowrap;
        }
        
        @media (min-width: 768px) {
            .color-label {
                font-size: 12px;
                margin-right: 10px;
            }
        }
        
        /* Menu top cho l·ª±a ch·ªçn model */
        .model-selector {
            background: royalblue;
            padding: 15px 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .model-menu {
            /* display: flex; */
            justify-content: center;
            align-items: center;
            gap: 15px;
            max-width: 1200px;
            margin: 0 auto;
            flex-wrap: wrap;
        }
        
        .model-label {
            color: #ecf0f1;
            font-weight: bold;
            font-size: 16px;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .model-btn {
            display: inline-block;
            padding: 10px 20px;
            background: #34495e;
            color: #ecf0f1;
            border: 2px solid #475569;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 110px;
            text-align: center;
            flex: 1;
            max-width: 150px;
        }
        
        .model-btn:hover {
            background: #475569;
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .model-btn.active {
            background: #3498db;
            border-color: #2980b9;
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
        }
        
        .model-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .model-name {
            font-size: 14px;
            font-weight: bold;
        }
        
        .model-desc {
            font-size: 11px;
            opacity: 0.8;
        }
        
        @media (max-width: 768px) {
            .model-menu {
                /* flex-direction: column; */
                gap: 10px;
            }
            
            .model-label {
                margin-right: 0;
                margin-bottom: 10px;
                text-align: center;
            }
            
            .model-btn {
                /* width: 100%; */
                max-width: 100px;
                flex: none;
                display: inline-block;
            }
        }
        
        @media (max-width: 480px) {
            .model-selector {
                padding: 10px 15px;
            }
            
            .model-btn {
                padding: 8px 15px;
                font-size: 13px;
                min-width: 90px;
            }
            
            .model-name {
                font-size: 13px;
            }
            
            .model-desc {
                font-size: 10px;
            }
        }
        
        /* QR Code cho mobile scanning */
        .qr-code {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 20;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #3498db;
        }
        
        .qr-code:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        
        .qr-code img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .qr-tooltip {
            position: absolute;
            top: -35px;
            left: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 5px 8px;
            border-radius: 4px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .qr-code:hover .qr-tooltip {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            .qr-code {
                width: 60px;
                height: 60px;
                top: 10px;
                left: 10px;
                padding: 6px;
            }
        }
    </style>
    
    <!-- Model Viewer CDN -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.3.0/model-viewer.min.js"></script>
</head>
<body>
    <div class="container">
        
        
            <h2 style="text-align: center; background-color: #272727; margin: 0px; padding: 10px; color: white;">
                 3D Model Demo  </h1>
        
        
        <!-- Menu top cho l·ª±a ch·ªçn model -->
        <div class="model-selector">
            <div class="model-menu" style="text-align: center;">
                <div class="model-label">üéÆ Ch·ªçn v·∫≠t th·ªÉ:</div>
                <div style="margin-top: 10px;">
                <button class="model-btn active" onclick="loadModel('files-3d/2_textured.glb', this)">
                    <div class="model-info">
                        <div class="model-name">M·∫´u 1</div>
                    </div>
                </button>
                <button class="model-btn" onclick="loadModel('files-3d/3_textured.glb', this)">
                    <div class="model-info">
                        <div class="model-name">M·∫´u 2</div>
                    </div>
                </button>
                <button class="model-btn" onclick="loadModel('files-3d/1_textured.glb', this)">
                    <div class="model-info">
                        <div class="model-name">M·∫´u 3</div>
                    </div>
                </button> 
                </div>
            </div>
        </div>
        
        <div class="viewer-wrapper">
            <div style="text-align: center;"> Xem tr√™n Mobile: 2 ng√≥n tay ƒë·ªÉ di chuy·ªÉn & zoom, 1 ng√≥n tay ƒë·ªÉ xoay </div>
            <div class="viewer-container">
                <!-- QR Code cho mobile scanning -->
                <div class="qr-code" onclick="showQRInfo()" title="Qu√©t QR ƒë·ªÉ xem tr√™n mobile">
                    <div class="qr-tooltip">üì± Qu√©t ƒë·ªÉ xem tr√™n mobile</div>
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://your-domain.com/demo-3d/index.html" 
                         alt="QR Code" 
                         id="qrCodeImg">
                </div>
                
                <model-viewer 
                    id="modelViewer"
                    src="files-3d/2_textured.glb" 
                    alt="3D Model from Maya"
                    auto-rotate 
                    camera-controls 
                    shadow-intensity="2"
                    exposure="1.8"
                    shadow-softness="0.2"
                    lighting="neutral"
                    skybox-image=""
                    environment-image=""
                    tone-mapping="aces"
                    loading="eager">
                    
                    <div class="progress-bar" style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); background: rgba(65,105,225,0.9); color: white; padding: 10px; border-radius: 5px; border: 2px solid #4169E1; box-shadow: 0 4px 15px rgba(65,105,225,0.5);">
                        <div>üîÑ ƒêang t·∫£i model...</div>
                    </div>
                </model-viewer>
            </div>
            
            <!-- 4 n√∫t ƒëi·ªÅu khi·ªÉn ƒë√®n ·ªü 4 g√≥c -->
            <div class="light-controls" style="display: none;">
                <div class="light-btn light-top-left active" onclick="toggleTopLeftLight()" title="ƒê√®n g√≥c tr√™n tr√°i">
                    ‚òÄÔ∏è
                </div>
                <div class="light-btn light-top-right" onclick="toggleTopRightLight()" title="ƒê√®n g√≥c tr√™n ph·∫£i">
                    üîÜ
                </div>
                <div class="light-btn light-bottom-left" onclick="toggleBottomLeftLight()" title="ƒê√®n g√≥c d∆∞·ªõi tr√°i">
                    üí°
                </div>
                <div class="light-btn light-bottom-right" onclick="toggleBottomRightLight()" title="ƒê√®n g√≥c d∆∞·ªõi ph·∫£i">
                    üåü
                </div>
            </div>
        </div>
        
        
        <div class="controls">
            <h3>üéõÔ∏è Ch·ªçn N·ªÅn</h3>
                        


            <!-- Background colors -->
            <div class="button-group">
                <button onclick="setBackgroundColor('#000000')" style="background: #000000;">‚ö´</button>
                <button onclick="setBackgroundColor('#ffffff')" style="background: #ffffff; color: #000;">‚ö™</button>
                <button onclick="setBackgroundColor('#ccc')" style="background: #ccc; border: 3px solid #4CAF50;">üîò</button>
                <button onclick="setBackgroundColor('#0066cc')" style="background: #0066cc;">üîµ</button>
                <button onclick="setBackgroundColor('#cc0066')" style="background: #cc0066;">üî¥</button>
            </div>
            
            <div class="status">
                <strong>üí° H∆∞·ªõng d·∫´n:</strong><br>
                ‚Ä¢ K√©o: xoay ‚Ä¢ Scroll: zoom ‚Ä¢ Alt+k√©o: pan<br>
            </div>
        </div>
    </div>

    <script>
        const modelViewer = document.querySelector('#modelViewer');
        let autoRotateEnabled = true;
        let environmentEnabled = false;
        let shadowIntensity = 2;
        let currentModel = 'files-3d/2_textured.glb'; // Track current model
        
        // Tr·∫°ng th√°i 4 ƒë√®n (m·∫∑c ƒë·ªãnh ch·ªâ ƒë√®n g√≥c tr√™n tr√°i b·∫≠t)
        let lightStates = {
            topLeft: true,
            topRight: false,
            bottomLeft: false,
            bottomRight: false
        };
        
        // H√†m hi·ªÉn th·ªã th√¥ng tin QR Code
        function showQRInfo() {
            const currentUrl = window.location.href;
            alert(`üì± QR Code Information:\n\nURL hi·ªán t·∫°i: ${currentUrl}\n\nüí° H∆∞·ªõng d·∫´n:\n‚Ä¢ D√πng camera mobile ƒë·ªÉ qu√©t QR\n‚Ä¢ Ho·∫∑c m·ªü link tr·ª±c ti·∫øp tr√™n mobile\n‚Ä¢ ƒê·ªÉ c√≥ tr·∫£i nghi·ªám t·ªët nh·∫•t tr√™n mobile!`);
        }
        
        // H√†m c·∫≠p nh·∫≠t QR code v·ªõi URL hi·ªán t·∫°i
        function updateQRCode() {
            const currentUrl = window.location.href;
            const qrImg = document.getElementById('qrCodeImg');
            if (qrImg) {
                qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(currentUrl)}`;
            }
        }
        
        // C·∫≠p nh·∫≠t QR code khi trang load
        window.addEventListener('load', () => {
            setTimeout(updateQRCode, 1000); // Delay ƒë·ªÉ ƒë·∫£m b·∫£o URL ƒë√£ ƒë∆∞·ª£c set
        });
        
        // H√†m load model m·ªõi
        function loadModel(modelPath, buttonElement) {
            // Hi·ªán loading
            const progressBar = document.querySelector('.progress-bar');
            if (!progressBar) {
                const newProgressBar = document.createElement('div');
                newProgressBar.className = 'progress-bar';
                newProgressBar.style.cssText = 'position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); background: rgba(65,105,225,0.9); color: white; padding: 10px; border-radius: 5px; border: 2px solid #4169E1; box-shadow: 0 4px 15px rgba(65,105,225,0.5);';
                modelViewer.appendChild(newProgressBar);
            }
            document.querySelector('.progress-bar').style.display = 'block';
            document.querySelector('.progress-bar').innerHTML = '<div>üîÑ ƒêang t·∫£i model m·ªõi...</div>';
            
            // C·∫≠p nh·∫≠t model
            currentModel = modelPath;
            modelViewer.src = modelPath;
            
            // C·∫≠p nh·∫≠t active button
            document.querySelectorAll('.model-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            buttonElement.classList.add('active');
            
            // C·∫≠p nh·∫≠t download links
            updateDownloadLinks(modelPath);
            
            console.log(`üîÑ ƒê√£ chuy·ªÉn sang model: ${modelPath}`);
        }
        
        // H√†m c·∫≠p nh·∫≠t download links
        function updateDownloadLinks(modelPath) {
            // C·∫≠p nh·∫≠t c√°c link download n·∫øu c√≥
            const downloadButtons = document.querySelectorAll('[onclick*="downloadModel"]');
            downloadButtons.forEach(btn => {
                btn.setAttribute('onclick', `downloadCurrentModel()`);
            });
        }
        
        function downloadCurrentModel() {
            const link = document.createElement('a');
            link.href = currentModel;
            link.download = currentModel;
            link.click();
            console.log(`üì• T·∫£i xu·ªëng: ${currentModel}`);
        }
        
        function openCurrentModelInNewTab() {
            window.open(currentModel, '_blank');
            console.log(`üîó M·ªü trong tab m·ªõi: ${currentModel}`);
        }
        
        // Event listeners
        modelViewer.addEventListener('load', () => {
            console.log('Model loaded successfully!');
            const progressBar = document.querySelector('.progress-bar');
            if (progressBar) {
                progressBar.style.display = 'none';
            }
            
            // Kh√¥ng √°p d·ª•ng m√†u m·∫∑c ƒë·ªãnh ƒë·ªÉ texture hi·ªÉn th·ªã t·ª± nhi√™n
            // setModelColor('#cc6633'); // Commented out for textured models
            
            // Thi·∫øt l·∫≠p lighting m·∫∑c ƒë·ªãnh
            updateLighting();
        });
        
        modelViewer.addEventListener('error', (event) => {
            console.error('Error loading model:', event);
            document.querySelector('.progress-bar').innerHTML = '<div>‚ùå L·ªói t·∫£i model!</div>';
        });
        
        modelViewer.addEventListener('progress', (event) => {
            const progress = event.detail.totalProgress;
            const percent = (progress * 100).toFixed(1);
            document.querySelector('.progress-bar').innerHTML = `<div>üîÑ ƒêang t·∫£i: ${percent}%</div>`;
        });
        
        // Functions ƒëi·ªÅu khi·ªÉn 4 ƒë√®n ·ªü 4 g√≥c
        function toggleTopLeftLight() {
            lightStates.topLeft = !lightStates.topLeft;
            updateLightButton('topLeft');
            updateLighting();
            console.log(`‚òÄÔ∏è ƒê√®n g√≥c tr√™n tr√°i: ${lightStates.topLeft ? 'B·∫¨T' : 'T·∫ÆT'}`);
        }
        
        function toggleTopRightLight() {
            lightStates.topRight = !lightStates.topRight;
            updateLightButton('topRight');
            updateLighting();
            console.log(`üîÜ ƒê√®n g√≥c tr√™n ph·∫£i: ${lightStates.topRight ? 'B·∫¨T' : 'T·∫ÆT'}`);
        }
        
        function toggleBottomLeftLight() {
            lightStates.bottomLeft = !lightStates.bottomLeft;
            updateLightButton('bottomLeft');
            updateLighting();
            console.log(`üí° ƒê√®n g√≥c d∆∞·ªõi tr√°i: ${lightStates.bottomLeft ? 'B·∫¨T' : 'T·∫ÆT'}`);
        }
        
        function toggleBottomRightLight() {
            lightStates.bottomRight = !lightStates.bottomRight;
            updateLightButton('bottomRight');
            updateLighting();
            console.log(`üåü ƒê√®n g√≥c d∆∞·ªõi ph·∫£i: ${lightStates.bottomRight ? 'B·∫¨T' : 'T·∫ÆT'}`);
        }
        
        function updateLightButton(position) {
            const positionMap = {
                topLeft: 'top-left',
                topRight: 'top-right', 
                bottomLeft: 'bottom-left',
                bottomRight: 'bottom-right'
            };
            const button = document.querySelector(`.light-${positionMap[position]}`);
            if (lightStates[position]) {
                button.classList.add('active');
            } else {
                button.classList.remove('active');
            }
        }
        
        function updateLighting() {
            // T√≠nh to√°n exposure d·ª±a tr√™n s·ªë ƒë√®n b·∫≠t
            const activeLights = Object.values(lightStates).filter(state => state).length;
            let baseExposure = 1.0;
            
            if (activeLights === 0) {
                // Kh√¥ng c√≥ ƒë√®n n√†o -> r·∫•t t·ªëi
                baseExposure = 0.3;
                modelViewer.shadowIntensity = 0.1;
            } else if (activeLights === 1) {
                // 1 ƒë√®n -> √°nh s√°ng t·∫≠p trung
                baseExposure = 1.8;
                modelViewer.shadowIntensity = shadowIntensity * 1.5;
            } else if (activeLights === 2) {
                // 2 ƒë√®n -> c√¢n b·∫±ng
                baseExposure = 1.5;
                modelViewer.shadowIntensity = shadowIntensity;
            } else if (activeLights === 3) {
                // 3 ƒë√®n -> s√°ng
                baseExposure = 1.3;
                modelViewer.shadowIntensity = shadowIntensity * 0.8;
            } else {
                // 4 ƒë√®n -> r·∫•t s√°ng
                baseExposure = 1.1;
                modelViewer.shadowIntensity = shadowIntensity * 0.6;
            }
            
            // ƒêi·ªÅu ch·ªânh lighting d·ª±a tr√™n h∆∞·ªõng ƒë√®n
            let lightingType = "neutral";
            let shadowSoftness = 0.3;
            
            if (lightStates.top && !lightStates.bottom && !lightStates.left && !lightStates.right) {
                // Ch·ªâ ƒë√®n tr√™n -> √°nh s√°ng t·ª´ tr√™n xu·ªëng
                shadowSoftness = 0.1;
                baseExposure = 2.2;
            } else if (lightStates.left && lightStates.right && !lightStates.top && !lightStates.bottom) {
                // ƒê√®n tr√°i + ph·∫£i -> √°nh s√°ng ngang
                shadowSoftness = 0.2;
                baseExposure = 1.6;
            } else if (lightStates.top && lightStates.bottom && !lightStates.left && !lightStates.right) {
                // ƒê√®n tr√™n + d∆∞·ªõi -> √°nh s√°ng d·ªçc
                shadowSoftness = 0.4;
                baseExposure = 1.4;
            }
            
            modelViewer.exposure = baseExposure;
            modelViewer.shadowSoftness = shadowSoftness;
            modelViewer.lighting = lightingType;
            
            // Clear environment ƒë·ªÉ t·∫≠p trung v√†o directional lighting
            modelViewer.environmentImage = "";
            modelViewer.skyboxImage = "";
        }
        
        // Control functions (gi·ªØ nguy√™n)
        function toggleAutoRotate() {
            autoRotateEnabled = !autoRotateEnabled;
            modelViewer.autoRotate = autoRotateEnabled;
        }
        
        function resetCamera() {
            modelViewer.resetTurntableRotation();
            modelViewer.jumpCameraToGoal();
        }
        
        function toggleEnvironment() {
            environmentEnabled = !environmentEnabled;
            if (environmentEnabled) {
                setTempleEnvironment();
            } else {
                clearEnvironment();
            }
            console.log(`Environment: ${environmentEnabled ? 'ON' : 'OFF'}`);
        }
        
        // C√°c m√¥i tr∆∞·ªùng ch√¢u √Å c·ªï k√≠nh
        function setTempleEnvironment() {
            modelViewer.environmentImage = "https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/temple_garden_1k.hdr";
            modelViewer.skyboxImage = "https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/temple_garden_1k.hdr";
            environmentEnabled = true;
            console.log('üèÆ M√¥i tr∆∞·ªùng: ƒê√¨nh ch√πa');
        }
        
        function setBambooEnvironment() {
            modelViewer.environmentImage = "https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/bamboo_forest_1k.hdr";
            modelViewer.skyboxImage = "https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/bamboo_forest_1k.hdr";
            environmentEnabled = true;
            console.log('üéã M√¥i tr∆∞·ªùng: R·ª´ng tre');
        }
        
        function setGardenEnvironment() {
            modelViewer.environmentImage = "https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/japanese_garden_1k.hdr";
            modelViewer.skyboxImage = "https://dl.polyhaven.org/file/ph-assets/HDRIs/hdr/1k/japanese_garden_1k.hdr";
            environmentEnabled = true;
            console.log('üå∏ M√¥i tr∆∞·ªùng: V∆∞·ªùn Zen');
        }
        
        function clearEnvironment() {
            modelViewer.environmentImage = "";
            modelViewer.skyboxImage = "";
            environmentEnabled = false;
            console.log('üå´Ô∏è M√¥i tr∆∞·ªùng: Tr·ªëng');
        }
        
        // Preset lighting functions (c·∫≠p nh·∫≠t ƒë·ªÉ t∆∞∆°ng t√°c v·ªõi 4 ƒë√®n g√≥c)
        function setTopLighting() {
            lightStates = { topLeft: true, topRight: true, bottomLeft: false, bottomRight: false };
            updateAllLightButtons();
            updateLighting();
        }
        
        function setSideLighting() {
            lightStates = { topLeft: true, topRight: false, bottomLeft: true, bottomRight: false };
            updateAllLightButtons();
            updateLighting();
        }
        
        function setStudioLighting() {
            lightStates = { topLeft: true, topRight: true, bottomLeft: true, bottomRight: true };
            updateAllLightButtons();
            updateLighting();
        }
        
        function setSunsetLighting() {
            lightStates = { topLeft: false, topRight: true, bottomLeft: false, bottomRight: false };
            updateAllLightButtons();
            updateLighting();
        }
        
        function updateAllLightButtons() {
            Object.keys(lightStates).forEach(position => {
                updateLightButton(position);
            });
        }
        
        function increaseShadow() {
            shadowIntensity = Math.min(shadowIntensity * 1.3, 5.0);
            updateLighting();
            console.log(`üåë Shadow tƒÉng: ${shadowIntensity.toFixed(1)}`);
        }
        
        function decreaseShadow() {
            shadowIntensity = Math.max(shadowIntensity * 0.7, 0.2);
            updateLighting();
            console.log(`‚òÅÔ∏è Shadow gi·∫£m: ${shadowIntensity.toFixed(1)}`);
        }
        
        // H√†m ƒë·ªïi m√†u n·ªÅn
        function setBackgroundColor(color) {
            modelViewer.style.backgroundColor = color;
            console.log(`Background color changed to: ${color}`);
        }
        
        // H√†m ƒë·ªïi m√†u v·∫≠t th·ªÉ  
        function setModelColor(color) {
            const materials = modelViewer.model?.materials;
            if (materials) {
                materials.forEach(material => {
                    if (material.pbrMetallicRoughness) {
                        material.pbrMetallicRoughness.setBaseColorFactor([
                            parseInt(color.slice(1,3), 16) / 255,
                            parseInt(color.slice(3,5), 16) / 255,
                            parseInt(color.slice(5,7), 16) / 255,
                            1.0
                        ]);
                    }
                });
            }
            console.log(`Model color changed to: ${color}`);
        }
        
        // H√†m reset m√†u v·∫≠t th·ªÉ v·ªÅ texture g·ªëc
        function resetModelColor() {
            // Reset v·ªÅ texture g·ªëc b·∫±ng c√°ch reload model
            const currentSrc = modelViewer.src;
            modelViewer.src = '';
            setTimeout(() => {
                modelViewer.src = currentSrc;
            }, 100);
            console.log('Model reset to original texture');
        }
        
        function downloadModel() {
            downloadCurrentModel();
        }
        
        function openInNewTab() {
            openCurrentModelInNewTab();
        }
    </script>
</body>
</html>
